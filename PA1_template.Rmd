---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r}
actData <- read.csv(unz("activity.zip", "activity.csv"), 
                    colClasses = c("numeric", "character","integer"), header = T)
```

Parse date in the order year, month, and days 
```{r}
library(lubridate)
actData$date <- ymd(actData$date)
```

## What is mean total number of steps taken per day?
```{r}
totSteps <- tapply(actData$steps, actData$date, FUN = sum, na.rm = TRUE)
mean(totSteps)
```

Also the median could be calculated as follows

```{r}
median(totSteps)
```

For the total number of steps taken by day 
```{r}
library(plyr)
library(dplyr)
dailySteps <- print(summarize(group_by(filter(actData, !is.na(steps)), date), dailySteps = sum(steps)))

```

The histogram for the total daily steps

```{r}
library(ggplot2)
ggplot(dailySteps, aes(x=date, y=dailySteps)) + 
        geom_histogram(stat="identity", colour = "black", fill = "green") +
        xlab("Days") + ylab("Number of Steps") + 
        labs(title= "Total number of steps per day") 
```



## What is the average daily activity pattern?
Calculating the average number of steps in each interval

```{r}
intervalAvgSteps <- print(summarize(group_by(filter(actData, !is.na(steps)), interval), intervalAvgSteps = mean(steps)))
```

The time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

```{r}
plot(intervalAvgSteps, type = "l", xlab = "The 5-minute Intervals", ylab = "Avg. number of steps", main = "The average number of steps across all days")
```

Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r}
actData$interval[max(intervalAvgSteps[2])]
```


## Imputing missing values
Calculating the total number of missing values for all the coloumns
```{r}
totMissingSteps       <- sum(is.na(actData$steps))
totMissingDates       <- sum(is.na(actData$date))
totMissingIntervals   <- sum(is.na(actData$interval))
print(totMissingSteps + totMissingDates + totMissingIntervals)
```
Note There are only missing values in the **steps** coloumn 


I'll use the mean of the total number of steps to fill in the NA value's places 

```{r}
newData <- mutate(group_by(actData, interval), steps = ifelse(is.na(steps), 
                                           mean(steps, na.rm=TRUE), steps))
head(newData)
```



## Are there differences in activity patterns between weekdays and weekends?
